<include file="Public/header"/>
<div class="layui-tab-brief main-tab-container">
    <ul class="layui-tab-title main-tab-title">
      <a href="{:U('index')}"><li>会员列表</li></a>
      <a href="{:U('edit')}"><li class="layui-this">添加 / 编辑会员</li></a>
      <a href="{:U('group')}"><li>会员组列表</li></a>
      <a href="{:U('group_edit')}"><li>添加 / 编辑会员组</li></a>
      <div class="main-tab-item">会员管理</div>
    </ul>
    <div class="layui-tab-content">
      <div class="layui-tab-item layui-show">
        <form class="layui-form">
          <div class="layui-tab layui-tab-card">
            <ul class="layui-tab-title">
              <li class="layui-this">基本选项</li>
            </ul>
            <div class="layui-tab-content">
              <div class="layui-tab-item layui-show">
                {:Form::select('gid',$info['gid'],'会员组','',$group,'name')}
                {:Form::input('text','username',$info['username'],'用户名','','','required')}
                {:Form::input('password','password','','密码','','','')}
                {:Form::input('password','repassword','','确认密码','','','')}
                {:Form::input('text','nickname',$info['nickname'],'昵称','','','')}
                {:Form::upload('head_img', $info['head_img'], '头像', '','head_img')}
                {:Form::input('text','email',$info['email'],'邮箱','','','')}
                {:Form::input('text','mobile',$info['mobile'],'手机','','','')}
                {:Form::input('text','address',$info['address'],'地址','','','')}
                {:Form::radio('is_enable',1,'是否启用','',array(1=>'是',0=>'否'))}
              </div>
              <div class="layui-form-item">
                <div class="layui-input-block">
                  <input type="hidden" name="id" value="{$info.id}"/>
                  <button class="layui-btn" lay-submit="" lay-filter="form_submit">保存</button>
                </div>
              </div>
            </div>
          </div>
          
        </form>
      </div>
    </div>
</div>
<script type="text/javascript">
layui.use(['element', 'form', 'layedit'], function(){
  var element = layui.element()
  ,form = layui.form()
  ,jq = layui.jquery;
  
  //监听提交
  form.on('submit(form_submit)', function(data){
    loading = layer.load(2, {
      shade: [0.2,'#000'] //0.2透明度的白色背景
    });
    var param = data.field;
    jq.post('{:url("edit")}',param,function(data){
      if(data.status == 1){
        layer.close(loading);
        layer.msg(data.msg, {icon: 1, time: 1000}, function(){
          location.reload();//do something
        });
      }else{
        layer.close(loading);
        layer.msg(data.msg, {icon: 2, anim: 6, time: 1000});
      }
    });
    return false;
  });
  
})

</script>
</body>
</html>

